<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leave Request Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f9f9f9;
    }
    body.dark-mode {
      background-color: #1e1e1e;
      color: #f0f0f0;
    }
    body.dark-mode .leave-container {
      background: #2c2c2c;
    }
    body.dark-mode table {
      color: #fff;
    }

    /* Sidebar */
    .sidebar {
      height: 100vh;
      background: #39bfbf;
      color: white;
      position: fixed;
      top: 0;
      left: 0;
      width: 300px;
      padding-top: 30px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: width 0.3s ease;
      overflow: hidden;
      text-align: center;
    }

    .sidebar.collapsed {
      width: 70px;
    }

    .logo-container {
      margin-bottom: 20px;
    }

    .logo-text img {
      width: 120px;
      height: auto;
    }

    .logo-tagline {
      font-size: 12px;
      color: #fff;
      margin-top: 6px;
      font-weight: 400;
      line-height: 1.3;
    }

    .sidebar.collapsed .logo-text,
    .sidebar.collapsed .logo-tagline {
      display: none;
    }

    .menu {
      flex-grow: 1;
      text-align: left;
    }

    .sidebar a {
      display: flex;
      align-items: center;
      gap: 12px;
      color: #ffffff;
      padding: 14px 20px;
      text-decoration: none;
      font-size: 16px;
      margin: 8px 0;
      border-radius: 6px;
      transition: background 0.3s, padding 0.3s;
    }

    .sidebar a i {
      font-size: 18px;
      width: 20px;
      text-align: center;
    }

    .sidebar.collapsed a {
      justify-content: center;
      gap: 0;
      padding: 14px;
    }

    .sidebar.collapsed a span {
      display: none;
    }

    .sidebar a:hover {
      background: #12b5b5;
      color: #fff;
    }

    .logout {
      background: #39bfbf;
      color: #fff !important;
      font-size: 14px;
      padding: 10px 16px;
      margin: 15px;
      border-radius: 6px;
      text-align: center;
    }

    .logout i {
      font-size: 14px;
    }

    .logout:hover {
      background: #1a252f;
    }

    /* Toggle button */
    .toggle-btn {
      position: absolute;
      top: 15px;
      left: 15px;
      background: #39bfbf;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      border: none;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      transition: background 0.3s;
      z-index: 10;
    }

    .toggle-btn:hover {
      background: #39bfbf;
    }

    /* Main Content */
    .main-content {
      margin-left: 300px;
      padding: 20px;
      transition: margin-left 0.3s ease;
    }

    .main-content.collapsed {
      margin-left: 70px;
    }

    .leave-container {
      max-width: 850px;
      margin: 40px auto;
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .leave-header {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }

    .leave-header button {
      width: 50%;
      font-weight: bold;
      border-radius: 0;
    }

    .leave-header .active {
      background-color: #39bfbf;
      color: white;
    }

    .apply-btn {
      background-color: #39bfbf;
      color: white;
      font-weight: bold;
      border-radius: 50px;
      padding: 10px 25px;
      border: none;
    }

    .head {
      background-color: #39bfbf!important;
      color: white !important;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <button class="toggle-btn" id="toggle-btn">
      <i class="fa-solid fa-arrow-left"></i>
    </button>
    <div class="logo-container">
      <div class="logo-text"><img src="images/logo.png" alt="logo"></div>
      <div class="logo-tagline">Your Punctual Partner for Workforce<br>Management</div>
    </div>
    <div class="menu">
      <a href="emp_dashboard.jsp"><i class="fa-solid fa-house"></i> <span>Dashboard</span></a>
  <a href="EmpProfile.html"><i class="fa-solid fa-user"></i> <span>Profile</span></a>
  <a href="attendance.jsp"><i class="fa-solid fa-calendar-check"></i> <span>Attendance</span></a>
  <a href="LeaveRequest.html"><i class="fa-solid fa-plane-departure"></i> <span>Leave Request</span></a>
  <a href="EmpPaySlip.html"><i class="fa-solid fa-file-invoice-dollar"></i> <span>My Payslips</span></a>
  <a href="OtRequest.html"><i class="fa-solid fa-stopwatch me-2"></i> <span>OT Request</span></a>
    </div>
    <a href="#" class="logout"><i class="fa-solid fa-right-from-bracket"></i> <span>Logout</span></a>
  </div>

  <!-- Main Content -->
  <div class="main-content" id="main">
    <div class="leave-container">
      <div class="leave-header">
        <button id="btnNewLeave" class="btn btn-light active">New Leave</button>
        <button id="btnAppliedLeaves" class="btn btn-light">Applied Leaves</button>
      </div>

      <!-- New Leave Form -->
      <div id="newLeaveSection">
        <form id="leaveForm" novalidate>
          <!-- Leave Type -->
          <div class="mb-3">
			  <label class="form-label fw-bold">Leave Type:</label><br>
			  <div class="form-check form-check-inline">
			    <input class="form-check-input" type="radio" name="leaveType" id="EL" value="EL" required>
			    <label class="form-check-label" for="EL">EL</label>
			  </div>
			  <div class="form-check form-check-inline">
			    <input class="form-check-input" type="radio" name="leaveType" id="CL" value="CL">
			    <label class="form-check-label" for="CL">CL</label>
			  </div>
			  <div class="form-check form-check-inline">
			    <input class="form-check-input" type="radio" name="leaveType" id="SL" value="SL">
			    <label class="form-check-label" for="SL">SL</label>
			  </div>
			  <div class="form-check form-check-inline">
			    <input class="form-check-input" type="radio" name="leaveType" id="OD" value="OD">
			    <label class="form-check-label" for="OD">OD</label>
			  </div>
			  <div class="form-check form-check-inline">
			    <input class="form-check-input" type="radio" name="leaveType" id="ML" value="ML">
			    <label class="form-check-label" for="ML">ML</label>
			  </div>
			  <div class="form-check form-check-inline">
			    <input class="form-check-input" type="radio" name="leaveType" id="PL" value="PL">
			    <label class="form-check-label" for="PL">PL</label>
			  </div>
			  <!-- Removed d-block -->
			  <div class="invalid-feedback">Please select a leave type.</div>
			</div>
          

          <!-- Available Credit -->
          <div class="mb-3">
            <label class="fw-bold">Available Credit:</label>
            <span id="creditValue" class="ms-2">NA</span>
          </div>

          <!-- Dates -->
          <div class="row mb-3">
            <div class="col-md-6">
              <label class="form-label fw-bold">From:</label>
              <div class="d-flex">
                <input type="date" class="form-control me-2" name="fromDate" id="fromDate" required>
                <select class="form-select" id="fromHalf" name="fromHalf">
                  <option>First Half</option>
                  <option>Second Half</option>
                </select>
              </div>
              <div class="invalid-feedback">Please select a start date.</div>
            </div>
            <div class="col-md-6">
              <label class="form-label fw-bold">To:</label>
              <div class="d-flex">
                <input type="date" class="form-control me-2" name="toDate" id="toDate" required>
                <select class="form-select" id="toHalf" name="toHalf">
                  <option>First Half</option>
                  <option selected>Second Half</option>
                </select>
              </div>
              <div class="invalid-feedback">Please select an end date.</div>
            </div>
          </div>

          <!-- Total Days -->
          <div class="mb-3">
            <label class="fw-bold">Total Days:</label>
            <span id="totalDays" class="ms-2">0</span>
          </div>

          <!-- Reason -->
          <div class="mb-3">
            <label class="form-label fw-bold">Reason:</label>
            <textarea class="form-control" name="reason" placeholder="Enter reason for leave" required></textarea>
            <div class="invalid-feedback">Please provide a reason for leave.</div>
          </div>

          

          <!-- Apply Button -->
          <div class="text-center">
            <button type="submit" class="apply-btn">Apply</button>
          </div>
        </form>
      </div>

      <!-- Applied Leaves Section -->
      <div id="appliedLeavesSection" class="d-none">
        <h5 class="fw-bold mb-3">Previously Applied Leaves</h5>
        <table class="table table-bordered table-striped">
          <thead class="head">
            <tr>
              <th>Emp ID</th>
              <th>Name</th>
              <th>Leave Type</th>
              <th>From</th>
              <th>F/S half</th>
              <th>To</th>
              <th>F/S half</th>
              <th>No of days</th>
              <th>Credit days</th>
              <th>Reason</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>101</td>
              <td>Ravi</td>
              <td>SL</td>
              <td>2025-08-20</td>
              <td>First half</td>
              <td>2025-08-20</td>
              <td>First half</td>
              <td>0.5</td>
              <td>3</td>
              <td>Personal Leave</td>
              <td>Granted</td>
            </tr>
            <tr>
              <td>105</td>
              <td>Meghana</td>
              <td>CL</td>
              <td>2025-09-27</td>
              <td>First half</td>
              <td>2025-09-29</td>
              <td>Second half</td>
              <td>3</td>
              <td>5</td>
              <td>Personal Leave</td>
              <td>Cancelled</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // Sidebar toggle
    const sidebar = document.getElementById('sidebar');
    const main = document.getElementById('main');
    const toggleBtn = document.getElementById('toggle-btn');
    const toggleIcon = toggleBtn.querySelector('i');

    toggleBtn.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
      main.classList.toggle('collapsed');

      if (sidebar.classList.contains('collapsed')) {
        toggleIcon.classList.remove('fa-arrow-left');
        toggleIcon.classList.add('fa-bars');
      } else {
        toggleIcon.classList.remove('fa-bars');
        toggleIcon.classList.add('fa-arrow-left');
      }
    });

    // Leave Request Script
    const leaveCredits = { EL: 10, CL: 7, SL: 5, OD: 15, ML: 30, PL: 15 };

    const btnNew = document.getElementById("btnNewLeave");
    const btnApplied = document.getElementById("btnAppliedLeaves");
    const newLeaveSection = document.getElementById("newLeaveSection");
    const appliedSection = document.getElementById("appliedLeavesSection");
    const creditValue = document.getElementById("creditValue");
    const totalDaysSpan = document.getElementById("totalDays");

    btnNew.addEventListener("click", () => {
      btnNew.classList.add("active");
      btnApplied.classList.remove("active");
      newLeaveSection.classList.remove("d-none");
      appliedSection.classList.add("d-none");
    });

    btnApplied.addEventListener("click", () => {
      btnApplied.classList.add("active");
      btnNew.classList.remove("active");
      appliedSection.classList.remove("d-none");
      newLeaveSection.classList.add("d-none");
    });

    document.querySelectorAll("input[name='leaveType']").forEach(radio => {
      radio.addEventListener("change", () => {
        creditValue.textContent = leaveCredits[radio.value] ?? "NA";
      });
    });

    function calculateDays() {
      let fromDate = document.getElementById("fromDate").value;
      let toDate = document.getElementById("toDate").value;
      let fromHalf = document.getElementById("fromHalf").value;
      let toHalf = document.getElementById("toHalf").value;

      if (!fromDate || !toDate) return;

      let start = new Date(fromDate);
      let end = new Date(toDate);

      if (end < start) {
        alert("❌ To Date cannot be before From Date!");
        document.getElementById("toDate").value = "";
        totalDaysSpan.textContent = 0;
        return;
      }

      let diffDays = (end - start) / (1000 * 60 * 60 * 24) + 1;

      if (diffDays === 1) {
        if (fromHalf === "Second Half" && toHalf === "First Half") {
          diffDays = 0;
        } else if (fromHalf === "Second Half" && toHalf === "Second Half") {
          diffDays = 0.5;
        } else if (fromHalf === "First Half" && toHalf === "First Half") {
          diffDays = 0.5;
        }
      } else {
        if (fromHalf === "Second Half") diffDays -= 0.5;
        if (toHalf === "First Half") diffDays -= 0.5;
      }

      totalDaysSpan.textContent = diffDays;
    }

    document.getElementById("fromDate").addEventListener("change", calculateDays);
    document.getElementById("toDate").addEventListener("change", calculateDays);
    document.getElementById("fromHalf").addEventListener("change", calculateDays);
    document.getElementById("toHalf").addEventListener("change", calculateDays);

    (function () {
      'use strict'
      const form = document.getElementById('leaveForm');
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }
        form.classList.add('was-validated')
      }, false)
    })()
  </script>
</body>
</html>
